<h1>Login</h1>


<div fxLayout="row" fxLayoutGap="20px">
  <div fxLayout="row" fxFlex="100">

    <!-- login view -->
    <div fxLayout="column" fxFlex="350px" class="form-box" *ngIf="!image">
      <form (ngSubmit)="onSubmitLogin()" #loginForm="ngForm">

        <div *ngIf="globalError" class="alert alert-danger">{{globalError}}</div>

        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" class="form-control" name="username" id="username"
                 [(ngModel)]="credentials.username" appNotEmpty #username=ngModel>
          <div [hidden]="!(username.touched && username.invalid)" class="alert alert-danger">Username is required</div>
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" class="form-control" name="password" id="password"
                 [(ngModel)]="credentials.password" appNotEmpty #password=ngModel>
          <div [hidden]="!(password.touched && password.invalid)" class="alert alert-danger">Password is required</div>
        </div>
        <button type="submit" class="btn btn-success" [disabled]="!loginForm.form.valid">Login</button>
      </form>
    </div>


    <!-- initial MFA setup view -->
    <div fxLayout="column" fxFlex="100%" class="form-box" *ngIf="image">
      <p>The Open Banking Accellerator development portal uses multi-factor authentication (MFA) to protect your
        account from abuse. Please take the following steps. </p>
      <ol>
        <li>Download an authenticator app on your mobile phone. Authy is a popular choice, but others such as Google Authenticator can also be used.<br/><br/>

          <figure>
            <img src="../../assets/authy.webp" width="70" height="70"/>
            <figcaption><a href="https://authy.com/download/" target="_blank">Download Authy</a></figcaption>
          </figure>

          <br/><br/>
        </li>
        <li>
          Once installed, open your authenticator app and scan the QR code below to add a new account.
        </li>
        <li>
          Enter the code generated by your authenticator app in the input below.
          <app-mfa scenario="verify" [cognitoUser]="cognitoUser"></app-mfa>
        </li>
      </ol>

      <img *ngIf="image" [src]="image" width="148" height="148">
    </div>

    <!-- regular MFA view -->
    <div fxLayout="column" fxFlex="100%" class="form-box" *ngIf="showMfa">
      <app-mfa scenario="regular" [cognitoUser]="cognitoUser"></app-mfa>
    </div>


  </div>
</div>


